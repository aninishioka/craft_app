{% extends 'base.html' %}

{% block content %}

<div class="container project-details">

  {% if g.user.id == project.user.id %}
  <form class="mb-4">
    {{ g.csrf_form.hidden_tag() }}
    <button formaction="/projects/{{project.id}}/edit" class="btn btn-secondary">
      <i class="bi bi-pencil"></i> Edit
    </button>
    <button form="/projects/{{project.id}}/pin" class="btn btn-primary">
      <i class="bi bi-pin-angle"></i> Pin
    </button>
    <button formaction="/projects/{{project.id}}/delete" formmethod="POST" class="btn btn-danger">
      <i class="bi bi-trash3"></i> Delete
    </button>
  </form>
  {% endif %}

  <h1>{{ project.title }}</h1>

  {% if project.pattern %}
    <h2 class="project-details-pattern">Pattern:
    {{ project.pattern }}
    {% if project.designer %} by {{ project.designer }} {% endif %}
    </h2>
  {% endif %}

  {% if project.yarns or project.needles or project.yarns %}
    {% if project.needles %}
      <h2>Needles</h2>
      {% for needle in project.needles %}
        {{ needle.size }}
        {% if not loop.last %}
          <br>
        {% endif %}
      {% endfor %}
    {% endif %}
    {% if project.hooks %}
      <h2>Hooks</h2>
      {% for hook in project.hooks %}
        {{ hook.size }}
        {% if not loop.last %}
          <br>
        {% endif %}
      {% endfor %}
    {% endif %}
    {% if project.yarns %}
      <h2>Yarns</h2>
      {% for yarn in project.yarns %}
      <div class="yarn">
        Yarn: {{ yarn.yarn_name }}
        <br>
        Color: {{ yarn.color }}
        <br>
        {% if yarn.num_skeins and (yarn.skein_weight or yarn.skein_length) %}
          Amount: {{ yarn.num_skeins }} =
          {{ (yarn.num_skeins or 0) * (yarn.skein_length or 0)}} {{ yarn.skein_length_unit}} /
           {{ (yarn.num_skeins or 0) * (yarn.skein_weight or 0)}} {{ yarn.skein_weight_unit}}
        {% endif %}
        {% if not loop.last %}
          <br>
        {% endif %}
      </div>
      {% endfor %}
    {% endif %}
  {% endif %}

  <h2>Notes:</h2>
  <p>{{ project.content }}</p>
</div>

{% endblock %}